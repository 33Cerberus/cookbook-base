<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Best lifehacks</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #60a5fa;
      --border: #1f2937;
    }
    body { margin: 0; background: var(--bg); color: var(--text); font-family: system-ui, sans-serif; }
    .layout { display: grid; grid-template-columns: 280px 1fr; height: 100vh; }
    .sidebar { border-right: 1px solid var(--border); background: var(--panel); overflow-y: auto; }
    .main { overflow-y: auto; }
    header { padding: 12px 16px; border-bottom: 1px solid var(--border); }
    header h1 { margin: 0; font-size: 16px; }
    .list { padding: 8px; }
    .item { display: block; padding: 8px 10px; border-radius: 8px; margin: 4px 0; cursor: pointer; border: 1px solid transparent; }
    .item:hover { background: #0b1220; border-color: var(--border); }
    .item.active { background: #0b1220; border-color: var(--accent); }
    .content { max-width: 880px; margin: 0 auto; padding: 24px 24px 80px; }
    .markdown-body h1, .markdown-body h2 { border-bottom: 1px solid var(--border); padding-bottom: 4px; }
    .markdown-body pre { background: #0b1220; padding: 12px; border-radius: 8px; }
  </style>
</head>
<body>
<div id="app" class="layout">
  <aside class="sidebar">
    <header><h1>Lifehacks</h1></header>
    <div class="list">
      <div
        v-for="file in recipeFiles"
        :key="file.name"
        class="item"
        :class="{ active: file.name === selectedName }"
        @click="selectRecipe(file.name)"
      >
        {{ file.name.replace(/\.md$/, '') }}
      </div>
    </div>
  </aside>

  <main class="main">
    <div class="content">
      <article class="markdown-body" v-html="renderedHtml"></article>
    </div>
  </main>
</div>

<script>
const { createApp } = Vue;

createApp({
  data() {
    return {
      recipeFiles: [
        { name: 'HighProteinDinner.md' },
        { name: 'Exercise.md' },
        { name: 'Time Management.md' }
      ],
      selectedName: 'HighProteinDinner.md',
      renderedHtml: ''
    }
  },
  methods: {
    async selectRecipe(name) {
      this.selectedName = name;
      await this.fetchRecipeMarkdown(name);
    },
    async fetchRecipeMarkdown(name) {
      try {
        const url = `recipes/${encodeURIComponent(name)}`;
        const res = await fetch(url);
        if (!res.ok) throw new Error(`Could not load ${name}`);
        const md = await res.text();
        marked.setOptions({ breaks: true, mangle: false, headerIds: true });
        const dirty = marked.parse(md);
        this.renderedHtml = DOMPurify.sanitize(dirty);
        document.querySelector('.main')?.scrollTo({ top: 0, behavior: 'smooth' });
      } catch (e) {
        this.renderedHtml = `<p style="color:#f87171;">Error: ${e.message}</p>`;
      }
    }
  },
  mounted() {
    this.fetchRecipeMarkdown(this.selectedName);
  }
}).mount('#app');
</script>
</body>
</html>
